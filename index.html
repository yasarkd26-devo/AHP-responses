<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AHP Questionnaire – Online Shopping Platform Selection</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,600;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
/* ─── TOKENS ─── */
:root {
  --ink:     #0f1e35;
  --blue:    #1547a0;
  --mid:     #2563eb;
  --sky:     #dbeafe;
  --pale:    #f0f5ff;
  --bg:      #eef2f9;
  --card:    #ffffff;
  --line:    #d1daea;
  --muted:   #64748b;
  --ok:      #059669;
  --warn:    #d97706;
  --r:       12px;
  --shadow:  0 2px 16px rgba(15,30,53,.09);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Inter', sans-serif;
  background: var(--bg);
  color: var(--ink);
  min-height: 100vh;
  padding-bottom: 80px;
}

/* ─── HERO ─── */
.hero {
  background: linear-gradient(140deg, #081528 0%, #0f2d5e 45%, #1547a0 80%, #1d5cbf 100%);
  padding: 56px 24px 76px;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.hero::before {
  content: '';
  position: absolute; inset: 0;
  background:
    radial-gradient(ellipse 60% 50% at 80% 20%, rgba(37,99,235,.3) 0%, transparent 60%),
    radial-gradient(ellipse 40% 40% at 15% 75%, rgba(255,255,255,.04) 0%, transparent 55%);
  pointer-events: none;
}
.hero-inner { position: relative; max-width: 680px; margin: 0 auto; }

.tag {
  display: inline-flex; align-items: center; gap: 7px;
  border: 1px solid rgba(255,255,255,.25);
  background: rgba(255,255,255,.08);
  border-radius: 100px;
  padding: 5px 16px;
  font-size: 11px;
  letter-spacing: 1.6px;
  text-transform: uppercase;
  color: rgba(255,255,255,.8);
  margin-bottom: 22px;
}
.tag-dot { width: 6px; height: 6px; background: #60a5fa; border-radius: 50%; }

.hero h1 {
  font-family: 'Playfair Display', serif;
  font-size: clamp(20px, 3.8vw, 32px);
  color: #fff;
  line-height: 1.28;
  margin-bottom: 16px;
}
.hero h1 em { font-style: italic; color: #93c5fd; }

.hero p {
  font-size: 13.5px;
  color: rgba(255,255,255,.65);
  line-height: 1.75;
  max-width: 520px;
  margin: 0 auto 22px;
}
.hero-meta {
  font-size: 12px;
  color: rgba(255,255,255,.38);
  letter-spacing: .3px;
}

/* progress */
.prog-wrap { margin-top: 26px; }
.prog-track {
  background: rgba(255,255,255,.15);
  border-radius: 4px;
  height: 4px;
  overflow: hidden;
}
.prog-bar {
  height: 100%;
  background: linear-gradient(90deg, #60a5fa, #fff);
  border-radius: 4px;
  width: 0%;
  transition: width .35s ease;
}
.prog-meta {
  display: flex; justify-content: space-between;
  margin-top: 7px;
  font-size: 11.5px;
  color: rgba(255,255,255,.45);
}

/* ─── LAYOUT ─── */
.wrap {
  max-width: 860px;
  margin: -30px auto 0;
  padding: 0 16px;
}

/* ─── CARD ─── */
.card {
  background: var(--card);
  border-radius: var(--r);
  border: 1px solid rgba(209,218,234,.5);
  box-shadow: var(--shadow);
  margin-bottom: 20px;
  overflow: hidden;
  animation: rise .5s ease both;
}
.card:nth-child(2) { animation-delay: .07s; }
@keyframes rise {
  from { opacity:0; transform:translateY(20px); }
  to   { opacity:1; transform:none; }
}

.card-top {
  background: linear-gradient(90deg, #0f1e35 0%, #1547a0 100%);
  padding: 14px 22px;
  display: flex; align-items: center; gap: 11px;
}
.badge {
  background: rgba(255,255,255,.14);
  border: 1px solid rgba(255,255,255,.22);
  border-radius: 6px;
  padding: 3px 11px;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: rgba(255,255,255,.85);
  white-space: nowrap;
}
.card-top h2 {
  font-family: 'Playfair Display', serif;
  font-size: 17px;
  color: #fff;
  font-weight: 600;
}

.card-body { padding: 24px; }

/* ─── INSTR ─── */
.instr {
  background: var(--pale);
  border-left: 3px solid var(--mid);
  border-radius: 0 8px 8px 0;
  padding: 13px 16px;
  font-size: 13px;
  color: #1e3a6e;
  line-height: 1.7;
  margin-bottom: 20px;
}
.instr strong { font-weight: 600; }

/* ─── SCALE LEGEND ─── */
.scale-row {
  display: flex; flex-wrap: wrap; gap: 7px;
  margin-bottom: 20px;
}
.sc-item {
  display: flex; align-items: center; gap: 7px;
  background: var(--bg);
  border: 1px solid var(--line);
  border-radius: 8px;
  padding: 6px 13px;
  font-size: 12px;
}
.sc-num {
  width: 22px; height: 22px;
  border-radius: 50%;
  background: var(--ink);
  color: #fff;
  font-weight: 700;
  font-size: 11px;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}
.sc-txt { color: var(--muted); }

/* ─── FACTOR CHIPS ─── */
.chips { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 20px; }
.chip {
  background: var(--sky);
  border: 1px solid #bfdbfe;
  border-radius: 100px;
  padding: 4px 13px;
  font-size: 12px;
  color: var(--blue);
  font-weight: 500;
  cursor: default;
}
.chip b { font-weight: 700; margin-right: 3px; }

/* ─── COUNTER ─── */
.counter {
  font-size: 12.5px;
  color: var(--muted);
  margin-bottom: 14px;
  display: flex; align-items: center; gap: 6px;
}
.counter-num { font-weight: 600; color: var(--blue); }
.counter-bar {
  flex: 1;
  height: 4px;
  background: var(--line);
  border-radius: 2px;
  overflow: hidden;
  max-width: 200px;
}
.counter-fill {
  height: 100%;
  background: var(--mid);
  border-radius: 2px;
  transition: width .25s;
}

/* ─── AHP TABLE ─── */
.tbl-scroll { overflow-x: auto; -webkit-overflow-scrolling: touch; }

table.ahp {
  border-collapse: collapse;
  width: 100%;
  min-width: 680px;
  font-size: 13px;
}
table.ahp thead th {
  background: var(--ink);
  color: #fff;
  padding: 10px 6px;
  text-align: center;
  font-weight: 500;
  font-size: 12px;
  white-space: nowrap;
}
table.ahp thead th.lbl {
  text-align: left;
  padding-left: 14px;
  min-width: 155px;
  font-size: 13px;
}
table.ahp tr.dir-row th {
  background: var(--sky);
  color: var(--blue);
  font-size: 11.5px;
  font-weight: 600;
  padding: 5px 6px;
  letter-spacing: .2px;
}
table.ahp tr.dir-row th.lbl { background: var(--sky); }

table.ahp tbody tr { border-bottom: 1px solid #edf1f9; }
table.ahp tbody tr:nth-child(even) { background: var(--pale); }
table.ahp tbody tr:hover { background: #dbeafe44; }
table.ahp tbody td { padding: 8px 5px; text-align: center; }
table.ahp tbody td.fl {
  text-align: left;
  padding-left: 14px;
  font-weight: 500;
  color: var(--ink);
  font-size: 12.5px;
  line-height: 1.4;
  max-width: 160px;
}

/* custom radio */
.rr { display: none; }
.rl {
  display: inline-block;
  width: 22px; height: 22px;
  border-radius: 50%;
  border: 2px solid var(--line);
  cursor: pointer;
  transition: border-color .15s, background .15s, box-shadow .15s;
  position: relative;
  vertical-align: middle;
}
.rl:hover { border-color: var(--mid); background: #eff6ff; }
.rr:checked + .rl {
  background: var(--mid);
  border-color: var(--mid);
  box-shadow: 0 0 0 3px rgba(37,99,235,.18);
}
.rr:checked + .rl::after {
  content: '';
  position: absolute;
  inset: 50% 50%;
  transform: translate(-50%,-50%);
  top: 50%; left: 50%;
  margin: -3.5px 0 0 -3.5px;
  width: 7px; height: 7px;
  background: #fff;
  border-radius: 50%;
}

/* ─── SUBMIT ─── */
.submit-area { text-align: center; margin-top: 32px; }
.submit-btn {
  background: linear-gradient(135deg, var(--blue) 0%, var(--mid) 100%);
  color: #fff;
  border: none;
  border-radius: 100px;
  padding: 15px 56px;
  font-family: 'Inter', sans-serif;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 5px 24px rgba(37,99,235,.38);
  transition: transform .2s, box-shadow .2s;
  letter-spacing: .3px;
}
.submit-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(37,99,235,.45); }
.submit-btn:disabled { opacity: .6; cursor: not-allowed; transform: none; }

.submit-note {
  margin-top: 10px;
  font-size: 12px;
  color: var(--muted);
}

/* ─── TOAST ─── */
.toast {
  display: none;
  position: fixed;
  bottom: 28px; left: 50%;
  transform: translateX(-50%);
  background: #1e293b;
  color: #fff;
  border-radius: 100px;
  padding: 11px 24px;
  font-size: 13px;
  font-weight: 500;
  z-index: 999;
  box-shadow: 0 4px 20px rgba(0,0,0,.25);
  white-space: nowrap;
  animation: toastIn .3s ease;
}
@keyframes toastIn { from { opacity:0; transform: translateX(-50%) translateY(12px); } to { opacity:1; transform: translateX(-50%) translateY(0); } }
.toast.warn { background: #92400e; }
.toast.ok   { background: #065f46; }

/* ─── SUCCESS SCREEN ─── */
.success-screen {
  display: none;
  text-align: center;
  padding: 64px 24px;
}
.ok-ring {
  width: 80px; height: 80px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--ok), #10b981);
  display: flex; align-items: center; justify-content: center;
  font-size: 36px; color: #fff;
  margin: 0 auto 24px;
  box-shadow: 0 6px 28px rgba(5,150,105,.3);
}
.success-screen h2 {
  font-family: 'Playfair Display', serif;
  font-size: 30px;
  color: var(--ink);
  margin-bottom: 12px;
}
.success-screen p { color: var(--muted); font-size: 14px; line-height: 1.7; max-width: 420px; margin: 0 auto; }
.success-screen .tag-ok {
  display: inline-block;
  margin-top: 22px;
  background: #d1fae5;
  color: #065f46;
  border-radius: 100px;
  padding: 5px 18px;
  font-size: 12px;
  font-weight: 600;
}

@media(max-width:600px){ .card-body{padding:16px;} .hero{padding:40px 16px 60px;} }
</style>
</head>
<body>

<!-- ══ HERO ══ -->
<div class="hero">
  <div class="hero-inner">
    <div class="tag"><span class="tag-dot"></span>Dissertation Research · AHP Study</div>
    <h1>Factors Affecting<br><em>Online Shopping Platform Selection</em></h1>
    <p>This questionnaire collects pairwise judgments about 8 key factors. Your responses are used to derive AHP priority weights for an academic research study on e-commerce consumer behaviour in India.</p>
    <div class="hero-meta">Mohd Yasar &nbsp;·&nbsp; Roll No: 5KA &nbsp;·&nbsp; Section: A</div>
    <div class="prog-wrap">
      <div class="prog-track"><div class="prog-bar" id="progBar"></div></div>
      <div class="prog-meta">
        <span id="progLeft">0 of 28 pairs answered</span>
        <span id="progPct">0%</span>
      </div>
    </div>
  </div>
</div>

<div class="wrap">

<!-- ══ FORM ══ -->
<form id="ahpForm">

<div class="card">
  <div class="card-top">
    <span class="badge">AHP · 28 Pairs</span>
    <h2>Pairwise Comparison of Factors</h2>
  </div>
  <div class="card-body">

    <div class="instr">
      For each pair of factors, judge which is <strong>more important</strong> to you when choosing an online shopping platform — and by how much.<br>
      Mark one circle per row. <strong>Left circles</strong> → Factor A more important &nbsp;|&nbsp; <strong>Right circles</strong> → Factor B more important &nbsp;|&nbsp; <strong>Centre (1)</strong> → Equal importance.
    </div>

    <!-- Scale -->
    <div class="scale-row">
      <div class="sc-item"><div class="sc-num">1</div><span class="sc-txt">Equal</span></div>
      <div class="sc-item"><div class="sc-num">3</div><span class="sc-txt">Moderate</span></div>
      <div class="sc-item"><div class="sc-num">5</div><span class="sc-txt">Strong</span></div>
      <div class="sc-item"><div class="sc-num">7</div><span class="sc-txt">Very Strong</span></div>
      <div class="sc-item"><div class="sc-num">9</div><span class="sc-txt">Extreme</span></div>
      <div class="sc-item" style="font-size:11.5px;color:var(--muted);">2, 4, 6, 8 for intermediate</div>
    </div>

    <!-- Factor chips -->
    <div class="chips" id="chips"></div>

    <!-- Counter -->
    <div class="counter">
      Pairs answered:&nbsp;<span class="counter-num" id="cntDone">0</span>&nbsp;/ 28
      <div class="counter-bar"><div class="counter-fill" id="cntFill" style="width:0%"></div></div>
    </div>

    <!-- AHP table -->
    <div class="tbl-scroll">
      <table class="ahp">
        <thead>
          <tr>
            <th class="lbl">Factor A</th>
            <th>9</th><th>7</th><th>5</th><th>3</th>
            <th>1</th>
            <th>3</th><th>5</th><th>7</th><th>9</th>
            <th class="lbl">Factor B</th>
          </tr>
          <tr class="dir-row">
            <th class="lbl"></th>
            <th colspan="4" style="text-align:center">← A more important</th>
            <th style="text-align:center">Equal</th>
            <th colspan="4" style="text-align:center">B more important →</th>
            <th class="lbl"></th>
          </tr>
        </thead>
        <tbody id="ahpBody"></tbody>
      </table>
    </div>

  </div>
</div>

<div class="submit-area">
  <button type="submit" class="submit-btn" id="submitBtn">Submit Responses →</button>
  <div class="submit-note">Your responses will be saved to a Google Sheet.</div>
</div>

</form>

<!-- ══ SUCCESS ══ -->
<div class="success-screen" id="successScreen">
  <div class="ok-ring">✓</div>
  <h2>Response Submitted!</h2>
  <p>Thank you for participating in this research. Your pairwise judgments will be used to compute AHP priority weights for the dissertation on online shopping platform selection.</p>
  <div class="tag-ok">Saved to Google Sheets ✓</div>
  <p style="margin-top:18px;font-size:12px;color:#94a3b8;">— Mohd Yasar · Roll No: 5KA · Section: A</p>
</div>

</div><!-- /wrap -->

<!-- ══ TOAST ══ -->
<div class="toast" id="toast"></div>

<script>
// ─────────────────────────────────────────────
//  STEP 2: Paste your Google Apps Script URL here
//  after following the setup instructions below.
// ─────────────────────────────────────────────
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzKeXeJU0a5TbY8eafLcBWm2T3mcnx7zUWPxRXf3dht7judmHuCcap6Na06HrHtk1CiTw/exec";

// ─── Factor definitions ───
const factors = [
  { id:"F1", label:"Price & Cost Factors" },
  { id:"F2", label:"Delivery & Logistics" },
  { id:"F3", label:"Product-Related Factors" },
  { id:"F4", label:"Website / App & Technology" },
  { id:"F5", label:"Trust & Security" },
  { id:"F6", label:"Payment & Transaction" },
  { id:"F7", label:"Customer Service Quality" },
  { id:"F8", label:"Social & Psychological Factors" },
];
const n = factors.length; // 8 → 28 pairs
const TOTAL = (n * (n-1)) / 2; // 28

// ─── Build factor chips ───
const chipsEl = document.getElementById('chips');
factors.forEach(f => {
  const d = document.createElement('div');
  d.className = 'chip';
  d.innerHTML = `<b>${f.id}</b>${f.label}`;
  chipsEl.appendChild(d);
});

// Scale column values:
// Index 0–3 → A more important (9,7,5,3), Index 4 → Equal (1), Index 5–8 → B more important (3,5,7,9)
const COL_DISPLAY = [9,7,5,3,1,3,5,7,9];

// ─── Build AHP table rows ───
const tbody = document.getElementById('ahpBody');
let pairCount = 0;

for (let i = 0; i < n; i++) {
  for (let j = i+1; j < n; j++) {
    pairCount++;
    const name = `p_${i}_${j}`;
    const tr = document.createElement('tr');

    // Factor A label
    const tdA = document.createElement('td');
    tdA.className = 'fl';
    tdA.innerHTML = `<span style="color:var(--blue);font-weight:600">${factors[i].id}</span>: ${factors[i].label}`;
    tr.appendChild(tdA);

    // 9 radio cells
    COL_DISPLAY.forEach((display, k) => {
      // Encode the actual AHP value:
      // k<4  → A is more important; value = -(display) meaning A is display× more important
      // k==4 → equal; value = 1
      // k>4  → B is more important; value = display
      let val;
      if      (k < 4)  val = -display;   // A side
      else if (k === 4) val = 1;          // equal
      else              val = display;    // B side

      const td = document.createElement('td');
      const id = `${name}_${k}`;
      const tip = k < 4
        ? `${factors[i].id} is ${display}× more important`
        : k === 4 ? 'Equal importance'
        : `${factors[j].id} is ${display}× more important`;

      td.innerHTML = `<input type="radio" name="${name}" value="${val}" id="${id}" class="rr">
                      <label for="${id}" class="rl" title="${tip}"></label>`;
      tr.appendChild(td);
    });

    // Factor B label
    const tdB = document.createElement('td');
    tdB.className = 'fl';
    tdB.innerHTML = `<span style="color:var(--blue);font-weight:600">${factors[j].id}</span>: ${factors[j].label}`;
    tr.appendChild(tdB);

    tbody.appendChild(tr);
  }
}

// ─── Progress tracking ───
function getAnswered() {
  let done = 0;
  for (let i=0;i<n;i++) for (let j=i+1;j<n;j++)
    if (document.querySelector(`input[name="p_${i}_${j}"]:checked`)) done++;
  return done;
}

function updateProgress() {
  const done = getAnswered();
  const pct  = Math.round(done / TOTAL * 100);
  document.getElementById('progBar').style.width  = pct + '%';
  document.getElementById('progPct').textContent  = pct + '%';
  document.getElementById('progLeft').textContent = `${done} of ${TOTAL} pairs answered`;
  document.getElementById('cntDone').textContent  = done;
  document.getElementById('cntFill').style.width  = pct + '%';
}
document.getElementById('ahpForm').addEventListener('change', updateProgress);

// ─── Toast helper ───
function showToast(msg, type='', duration=3500) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className   = 'toast ' + type;
  t.style.display = 'block';
  setTimeout(() => { t.style.display = 'none'; }, duration);
}

// ─── Build AHP reciprocal matrix & flat row for Sheets ───
function buildMatrixRow() {
  // Returns: timestamp, then for each pair i<j: "Fi_vs_Fj = X"
  // Also returns the full 8x8 matrix as JSON for analysis
  const matrix = Array.from({length:n}, () => Array(n).fill(1));
  const pairs   = [];

  for (let i=0;i<n;i++) {
    for (let j=i+1;j<n;j++) {
      const el = document.querySelector(`input[name="p_${i}_${j}"]:checked`);
      let val = null;
      if (el) {
        const raw = parseFloat(el.value);
        if (raw < 0) {
          // A more important
          matrix[i][j] = Math.abs(raw);
          matrix[j][i] = +(1 / Math.abs(raw)).toFixed(4);
          val = Math.abs(raw);              // from A's perspective
        } else if (raw === 1) {
          matrix[i][j] = 1;
          matrix[j][i] = 1;
          val = 1;
        } else {
          // B more important
          matrix[j][i] = raw;
          matrix[i][j] = +(1 / raw).toFixed(4);
          val = raw;                        // from B's perspective (reciprocal already set)
        }
      }
      pairs.push(`${factors[i].id}_vs_${factors[j].id}:${val !== null ? val : 'NA'}`);
    }
  }
  return { matrix, pairs };
}

// ─── Submit ───
document.getElementById('ahpForm').addEventListener('submit', async function(e) {
  e.preventDefault();

  // Validation
  const done = getAnswered();
  if (done < TOTAL) {
    showToast(`⚠ Please answer all 28 pairs (${TOTAL - done} remaining)`, 'warn', 4000);
    // scroll to first unanswered
    for (let i=0;i<n;i++) {
      for (let j=i+1;j<n;j++) {
        if (!document.querySelector(`input[name="p_${i}_${j}"]:checked`)) {
          document.querySelector(`input[name="p_${i}_${j}"]`).closest('tr').scrollIntoView({ behavior:'smooth', block:'center' });
          return;
        }
      }
    }
    return;
  }

  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.textContent = 'Submitting…';

  const { matrix, pairs } = buildMatrixRow();
  const timestamp = new Date().toISOString();

  // Payload for Google Sheets
  const payload = {
    timestamp,
    pairs,                          // array of "Fi_vs_Fj:value" strings
    matrix: JSON.stringify(matrix)  // full reciprocal matrix as JSON string
  };

  try {

  await fetch(SCRIPT_URL, {
    method: 'POST',
    mode: 'no-cors',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  });

  document.getElementById('ahpForm').style.display = 'none';
  document.getElementById('successScreen').style.display = 'block';
  window.scrollTo({ top: 0, behavior: 'smooth' });

} catch (err) {
  console.error("Submission error:", err);
  btn.disabled = false;
  btn.textContent = 'Submit Responses →';
  showToast('❌ Submission failed — check internet', 'warn', 4000);
}
});
</script>
</body>
</html>
